<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Furniture Mover â€” Reliable Moving Services</title>
  <meta name="description" content="Safe and affordable furniture moving across Nepal. Book online and track your move.">
  <!-- English-friendly font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.css" />
  <link rel="stylesheet" href="/static/css/style.css">
  <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body class="app-body">

  <nav class="navbar navbar-expand-lg navbar-dark navbar-modern" id="mainNavbar">
    <div class="container">
      <a class="navbar-brand" href="{{ url_for('main.home') }}">
        <img src="/static/images/maal-gaadi-logo.png" alt="Maal Gaadi Logo">
        <span class="brand-text">Maal Gaadi</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav" aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="mainNav">
        <ul class="navbar-nav ms-auto align-items-lg-center">
          <li class="nav-item"><a class="nav-link" href="{{ url_for('main.home') }}"><i class="fa-solid fa-house me-1"></i>Home</a></li>
          <li class="nav-item"><a class="nav-link" href="{{ url_for('main.vehicles') }}"><i class="fa-solid fa-truck-fast me-1"></i>Vehicles</a></li>
          {% if current_user.is_authenticated %}
            <li class="nav-item"><a class="nav-link" href="{{ url_for('main.profile') }}"><i class="fa-solid fa-user me-1"></i>Profile</a></li>
            <li class="nav-item"><a class="nav-link" href="{{ url_for('booking.book') }}"><i class="fa-solid fa-calendar-check me-1"></i>Book</a></li>
            {% if current_user.role == 'driver' or current_user.role == 'admin' or current_user.driver_status in ['pending','rejected'] %}
              <li class="nav-item"><a class="nav-link" href="{{ url_for('driver.driver_dashboard') }}"><i class="fa-solid fa-road me-1"></i>Driver</a></li>
            {% endif %}
            {% if current_user.role == 'admin' %}
              <li class="nav-item"><a class="nav-link" href="{{ url_for('admin.admin_dashboard') }}"><i class="fa-solid fa-shield-halved me-1"></i>Admin</a></li>
            {% endif %}
            <li class="nav-item"><a class="nav-link btn btn-outline-light ms-2" href="{{ url_for('auth.logout') }}"><i class="fa-solid fa-right-from-bracket me-1"></i>Logout</a></li>
          {% else %}
            <li class="nav-item"><a class="nav-link" href="{{ url_for('auth.login') }}"><i class="fa-solid fa-right-to-bracket me-1"></i>Login</a></li>
            <li class="nav-item"><a class="nav-link btn btn-primary text-white ms-2" href="{{ url_for('auth.signup') }}"><i class="fa-solid fa-user-plus me-1"></i>Sign Up</a></li>
          {% endif %}
        </ul>
      </div>
    </div>
  </nav>

  {% if request.endpoint == 'main.home' %}
    <header class="hero py-5" id="top">
      <div class="container d-flex flex-column flex-lg-row align-items-center gap-4">
        <div class="hero-text flex-shrink-0">
          {% if current_user.is_authenticated %}
            <div class="card shadow-sm p-4 mb-4" style="border-radius: 16px; background: rgba(255, 255, 255, 0.95);">
              <div class="d-flex align-items-center gap-3">
                <img src="{{ current_user.profile_pic or 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?auto=format&fit=crop&w=200&q=60' }}" alt="Profile picture" class="rounded-circle" style="width:80px; height:80px; object-fit:cover; border: 4px solid white; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
                <div>
                  <div class="fw-bold" style="font-size: 1.3rem; color: var(--primary);">Welcome back, {{ current_user.full_name or current_user.username }}!</div>
                  <small class="text-muted" style="font-size: 1rem;">Ready for your next move?</small>
                </div>
                <div class="ms-auto">
                  <a href="{{ url_for('main.profile') }}" class="btn btn-outline-primary">View Profile</a>
                </div>
              </div>
            </div>
          {% endif %}
          <h1 class="display-5 fw-bold">Smart Truck Booking Across Kathmandu Valley</h1>
          <p class="lead">Premium logistics for homes and businesses. Real-time tracking, verified drivers, and transparent pricing for every move.</p>
          <p class="mt-4">
            <a class="btn btn-primary btn-lg me-2" href="{{ url_for('booking.book') }}"><i class="fa-solid fa-truck-fast me-2"></i>Book Now</a>
            {% if not current_user.is_authenticated %}
              <a class="btn btn-outline-light btn-lg" href="{{ url_for('auth.signup') }}">Get Started</a>
            {% endif %}
          </p>

          <div class="mt-4 d-flex gap-3 flex-wrap">
            <span class="accent-pill accent-1">âœ“ Fully Insured</span>
            <span class="accent-pill accent-2">âœ“ Live Tracking</span>
            <span class="accent-pill" style="background: var(--gradient-success); color: white;">âœ“ Best Rates</span>
          </div>

          <div class="mt-4 text-white" style="opacity: 0.9;">
            <strong>ğŸ“ Service Areas:</strong> Kathmandu â€¢ Lalitpur â€¢ Bhaktapur
          </div>
        </div>
      </div>
    </header>
  {% endif %}

  <main class="container page-content">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for cat, msg in messages %}
          <div class="flash {{ cat }}">{{ msg }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    {% block content %}{% endblock %}
  </main>

  <footer class="site-footer">
    <div class="container">
      <div class="row">
        <div class="col-md-4 mb-3">
          <h5 class="fw-bold mb-3">ğŸšš Furniture Mover</h5>
          <p class="small" style="opacity: 0.9;">Professional moving services with cutting-edge tracking technology and customer-first approach.</p>
        </div>
        <div class="col-md-4 mb-3">
          <h6 class="fw-bold mb-3">Quick Links</h6>
          <ul class="list-unstyled">
            <li><a href="{{ url_for('main.home') }}">Home</a></li>
            <li><a href="{{ url_for('main.vehicles') }}">Our Vehicles</a></li>
            <li><a href="{{ url_for('booking.book') }}">Book Now</a></li>
          </ul>
        </div>
        <div class="col-md-4 mb-3">
          <h6 class="fw-bold mb-3">Connect With Us</h6>
          <div class="social mb-3">
            <a href="#" aria-label="Facebook">ğŸ“˜</a>
            <a href="#" aria-label="Twitter">ğŸ¦</a>
            <a href="#" aria-label="Instagram">ğŸ“·</a>
          </div>
          <p class="small">ğŸ“§ info@furnituremover.com<br>ğŸ“ +977-1-1234567</p>
        </div>
      </div>
      <div class="text-center pt-3 mt-3" style="border-top: 1px solid rgba(255,255,255,0.2); opacity: 0.8;">
        <small>&copy; 2026 Furniture Mover. All rights reserved.</small>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
  <script src="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.min.js"></script>
  <script>
    // Small helper: enable Bootstrap tooltips if used
    document.addEventListener('DOMContentLoaded', function () {
      const navbar = document.getElementById('mainNavbar');
      const handleScroll = () => {
        if (!navbar) return;
        if (window.scrollY > 20) {
          navbar.classList.add('navbar-solid');
        } else {
          navbar.classList.remove('navbar-solid');
        }
      };
      handleScroll();
      window.addEventListener('scroll', handleScroll);

      var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
      tooltipTriggerList.forEach(function (tooltipTriggerEl) {
        new bootstrap.Tooltip(tooltipTriggerEl)
      })
      
      // Fix modal z-index and ensure they appear above backdrop
      document.querySelectorAll('.modal').forEach(function(modal) {
        modal.addEventListener('show.bs.modal', function () {
          // Move modal to body to avoid z-index stacking issues
          if (modal.parentElement.tagName !== 'BODY') {
            document.body.appendChild(modal);
          }
          // Ensure proper z-index
          setTimeout(() => {
            const backdrop = document.querySelector('.modal-backdrop');
            if (backdrop) {
              backdrop.style.zIndex = '1040';
            }
            modal.style.zIndex = '1050';
            modal.style.display = 'block';
          }, 10);
        });
      });
    })
  </script>
  {% block extra_js %}{% endblock %}
</body>
</html>